create TABLE IF NOT EXISTS PUBLIC."user"(
	id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	email VARCHAR(255) NOT NULL,
	login VARCHAR(255) NOT NULL,
	name VARCHAR(255),
	birthday DATE NOT NULL
);

create TABLE IF NOT EXISTS PUBLIC."friendship"(
	user_id BIGINT NOT NULL REFERENCES PUBLIC."user"(id),
	friend_id BIGINT NOT NULL REFERENCES PUBLIC."user"(id),
	is_approved BOOLEAN
);


create TABLE IF NOT EXISTS PUBLIC."mpa" (
    id            BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name          VARCHAR(10) NOT NULL UNIQUE
);


create TABLE IF NOT EXISTS PUBLIC."film"(
	id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	name VARCHAR(255) NOT NULL,
	description VARCHAR(200),
	release_date DATE NOT NULL,
	duration INTEGER NOT NULL,
	rate BIGINT,
	mpa_id INTEGER REFERENCES PUBLIC."mpa"(id)
);

create TABLE IF NOT EXISTS PUBLIC."like"(
	film_id BIGINT NOT NULL REFERENCES PUBLIC."film"(id),
	user_id BIGINT NOT NULL REFERENCES PUBLIC."user"(id)
);


create TABLE IF NOT EXISTS PUBLIC."genre"(
	id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	name VARCHAR(255) NOT NULL UNIQUE
);

create TABLE IF NOT EXISTS PUBLIC."film_genres"(
	film_id BIGINT NOT NULL REFERENCES PUBLIC."film"(id) ON DELETE CASCADE,
	genre_id INTEGER NOT NULL REFERENCES PUBLIC."genre"(id)
);
